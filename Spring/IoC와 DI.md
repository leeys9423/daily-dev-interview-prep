# IoC(제어의 역전), DI

### 정의

스프링 프레임워크의 핵심 원리 중 하나로, 객체의 생성, 생명주기, 의존성 관리 등의 제어권이 개발자에서 프레임워크로 넘어가는 것을 의미

### 장점

1. 코드 결합도 감소
   - 객체들 간의 강한 결합이 약한 결합으로 변경됨
   - 인터페이스에 의존하여 구현체 교체가 용이
2. 유지보수성 향상
   - 의존성이 명확하게 드러나 코드 이해가 쉬워짐
   - 객체 교체가 용이하여 리팩토링 비용 감소
3. 테스트 용이성
   - 목(Mock) 객체를 쉽게 주입하여 단위 테스트 가능
   - 컴포넌트를 격리하여 테스트 가능
4. 코드 재사용성
   - 객체 생성을 전문 팩토리 클래스에 위임
   - IoC 컨테이너는 일종의 고급 팩토리 역할 수행

### 면접질문. 스프링 DI와 IoC에 대해서 설명해주세요

→ 스프링 IoC(제어의 역전)는 스프링 프레임워크의 핵심 원리로, 객체 생성과 생명주기 관리의 책임을 개발자가 아닌 스프링 프레임워크에 위임하는 것입니다.

전통적인 방식에서는 개발자가 직접 `new` 키워드로 객체를 생성하고 의존성을 설정했지만, IoC에서는 이러한 제어권이 스프링 컨테이너로 넘어갑니다. 이를 통해 객체 간의 결합도를 낮추고 코드의 유연성과 테스트 용이성을 높일 수 있습니다.

DI는 IoC를 구현하는 가장 중요한 방법입니다. 스프링은 DI를 통해 객체가 필요로 하는 의존성을 외부에서 주입해줍니다. DI는 크게 생성자 주입, 세터 주입, 필드 주입의 세 가지 방식으로 구현할 수 있습니다.

### 객체 주입 방식

생성자 주입, 세터 주입, 필드 주입

### 생성자 방식에 이점

첫 번째로 불변성을 보장할 수 있습니다. 생성자에서 final 키워드와 함께 의존성을 주입받으면, 객체가 생성된 후에는 의존성이 변경될 수 없습니다. 이는 멀티스레드 환경에서 안전하고 예측 가능한 동작을 보장합니다.

두 번째는 필수 의존성을 명확하게 표현할 수 있다는 점입니다. 생성자의 파라미터를 보면 이 클래스가 동작하기 위해 반드시 필요한 의존성이 무엇인지 한눈에 알 수 있습니다. 만약 의존성 없이 객체를 생성하려고 하면 컴파일 타임에 오류가 발생합니다.

세 번째로 테스트 용이성입니다. 단위 테스트를 작성할 때 스프링 컨테이너 없이도 간단히 목 객체를 생성자에 전달해서 테스트할 수 있습니다.

네 번째로 순환 의존성을 컴파일 타임에 발견할 수 있다는 점입니다.

### 필드 주입을 권장하지 않는 이유

가장 큰 문제는 테스트의 어려움입니다. 필드 주입을 사용하면 스프링 컨테이너 없이는 의존성을 주입할 방법이 없습니다.

불변성을 보장할 수 없다. 필드 주입된 객체는 런타임에 언제든 변경될 가능성이 있어 예측하기 어려운 동작을 할 수 있습니다.

순환 의존성 문제를 감춥니다. 필드 주입은 순환 의존성이 있어도 일단 객체 생성은 성공하고, 실제 메서드를 호출할 때 문제가 드러납니다. 이는 문제를 늦게 발견하게 만들어서 디버깅을 어렵게 합니다.

### 세터 주입은 언제 사용하는가

세터 주입은 선택적 의존성이 있을 때 사용합니다. 예를 들어 캐시 서비스가 있으면 성능이 좋아지지만, 없어도 기본 동작은 가능한 경우입니다.
